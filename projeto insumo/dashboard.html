<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Sistema de Gestão de Insumos</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100 text-gray-800">
    <header class="bg-white shadow-md sticky top-0 z-40">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center">
                <img src="https://storage.googleapis.com/gemini-prod-us-west1-d00d-uploads/a9d3eb80f9f821c9ed71eeed139349d0.jpg" alt="Logo Johnson & Johnson" class="h-10 w-auto">
            </div>
            <nav class="hidden md:flex items-center space-x-6">
                <a href="dashboard.html" class="text-gray-600 hover:text-red-700 font-medium pb-1 border-b-2 border-red-600">Dashboard</a>
                <a href="insumos.html" class="text-gray-600 hover:text-red-700 font-medium">Insumos</a>
                <a href="fornecedores.html" class="text-gray-600 hover:text-red-700 font-medium">Fornecedores</a>
                <a href="relatorios.html" class="text-gray-600 hover:text-red-700 font-medium">Relatórios</a>
                <a href="configuracoes.html" class="text-gray-600 hover:text-red-700 font-medium">Configurações</a>
            </nav>
            <div class="flex items-center space-x-4">
                <img class="h-16 w-16 rounded-full object-cover" src="https://placehold.co/150x150/E2E8F0/4A5568?text=AV" alt="User avatar">
                <button id="logout-btn" class="text-sm font-medium text-gray-600 hover:text-red-700">Sair</button>
            </div>
        </div>
    </header>
    <main class="container mx-auto p-6 md:p-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-6">Dashboard</h1>
        <p class="text-gray-600 mb-6">Resumo das atividades do sistema.</p>

        <!-- Indicadores-Chave -->
        <div id="key-indicators" class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-bold text-gray-800">Total de Insumos</h2>
                <p id="total-insumos" class="text-3xl font-bold text-red-600 mt-2">0</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-bold text-gray-800">Fornecedores Cadastrados</h2>
                <p id="total-fornecedores" class="text-3xl font-bold text-red-600 mt-2">0</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-bold text-gray-800">Estoque Crítico</h2>
                <p id="estoque-critico" class="text-3xl font-bold text-red-600 mt-2">0</p>
            </div>
        </div>

        <!-- Tabela Resumida -->
        <div class="bg-white rounded-lg shadow-sm p-6">
            <h2 class="text-xl font-bold text-gray-800 mb-4">Últimos Insumos Adicionados</h2>
            <table class="w-full text-sm text-left text-gray-500">
                <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3">ID</th>
                        <th scope="col" class="px-6 py-3">Nome</th>
                        <th scope="col" class="px-6 py-3">Quantidade</th>
                        <th scope="col" class="px-6 py-3">Data</th>
                    </tr>
                </thead>
                <tbody id="insumos-table-body">
                    <!-- Linhas serão injetadas dinamicamente -->
                </tbody>
            </table>
        </div>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const logoutBtn = document.getElementById('logout-btn');
            const totalInsumos = document.getElementById('total-insumos');
            const insumosTableBody = document.getElementById('insumos-table-body');

            // Recuperar insumos do Local Storage
            const insumos = JSON.parse(localStorage.getItem('insumos')) || [];

            const renderDashboard = () => {
                // Atualizar total de insumos
                totalInsumos.textContent = insumos.length;

                // Atualizar tabela de insumos
                insumosTableBody.innerHTML = '';
                insumos.forEach(insumo => {
                    const row = document.createElement('tr');
                    row.className = 'bg-white border-b hover:bg-gray-50';
                    row.innerHTML = `
                        <td class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">${insumo.id}</td>
                        <td class="px-6 py-4">${insumo.name}</td>
                        <td class="px-6 py-4 text-center">${insumo.quantity}</td>
                        <td class="px-6 py-4 text-center">${insumo.arrivalDate}</td>
                    `;
                    insumosTableBody.appendChild(row);
                });
            };

            if (logoutBtn) {
                logoutBtn.addEventListener('click', () => {
                    // Redirect to the login page
                    window.location.href = 'index.html';
                });
            }

            renderDashboard();
        });
    </script>
</body>
</html>
